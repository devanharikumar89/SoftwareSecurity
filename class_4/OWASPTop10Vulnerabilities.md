Sensitive Data exposure

- personal : credit card number, SSN, passwords, user names, Business : accounts etc, System related : server type, frameworks
results from improper classification and lack of authorization.

The CIA of infosec - confidentiality(verbose error messages, web service calls), integrity(sql injection, MIM attacks, http vulnerability) and availability(DOS attacks)

MD5, SHA1, RC1, RC3 - weak algorithms

Testing :

find the crypt algos and make sure they are used at the right place
make sure crypto algis are not homebrew. Make sure they are all compliant with corporate policy

Protect data at rest

SHA 512 should be used, Before hashing salt them
Use role based access
Logging user name migt be a bad idea because if you accidentally type in your password that will get stored too

Missing function level access control

AuthN - saying that you are alice and proving that you indeed are by providing the password
AuthZ - access control, If alice is not admin she does not get to use the admin privileges

Issues assoc with Missing func ...

1. Forceful browsing(people who can guess the links can access ), 2. vertical privilege escalation(unauth or a lower level person can access stuff that he should not be accessing), 3. Horizontal privilege escalation (same role but not allowed and still does)


Testing :
start with a site map - check if you can reach areas where you are not supposed to. 
Similarly test for vertial and horizontal

Proper access control - auth for each resource request, process managing entitlements, deny all access by default, do not rely on presentation layer access control, server side auth

Cross Site request Forgery :

makes a victim make a request to an entity that requires authentication
example : http requests can be hidden in an img tag.
Done on users behalf
another example : java script also can be used for this

test : tool called http proxy

Tokens are the best way to avoid this
generated dynamically, include a token for all forms the user can submit
attacker cannot predict the token because it is dynamially generated by the server
But if the malicios script is part of the application then we cannot do anything

3 other ways 

1. re enter password
2. use an OTP
3. captcha

Using Components with known vulnerabilities

Not all are reported, not aware that components are vulnerable, version numbering can make it difficult
flaws in any component can be very serious
Apache CXF and Spring Remote Code Execution - examples

Testing :
manual review of all apps
automate this process through a static analysis tool

Have a process in place to :

Most components dont get the fix for old versions, so keep updating
use mailing lists
establish security policies
add security wrappers around components


Unvalidated Redirects and Forwards

attacker links to an unvalidated redirect (started from a trust worthy website)
watch 121 of 127 (good)

Testing :
looks for areas where your application uses redirects and forwards
provide values for invalid redirects and see what happens


Always check the destination before forwarding
It is a good practice to only forward to a whitelisted set of resources and use proper access controls










